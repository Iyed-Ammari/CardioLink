{% extends 'dashboard/base_dashboard.html.twig' %}

{% block title %}Dashboard Admin{% endblock %}

{% block body %}

<h2>ğŸ“Š Dashboard Admin</h2>

<div style="display:flex; gap:20px; margin-bottom:30px; flex-wrap:wrap;">

    <div style="background:#fff; border-radius:16px; padding:24px; min-width:180px; box-shadow:0 4px 15px rgba(0,0,0,0.08); text-align:center;">
        <div style="font-size:36px;">ğŸ‘¥</div>
        <div style="font-size:32px; font-weight:800; color:#2F60F5;">{{ stats.patients }}</div>
        <div style="color:#6B7280; font-size:14px;">Patients</div>
    </div>

    <div style="background:#fff; border-radius:16px; padding:24px; min-width:180px; box-shadow:0 4px 15px rgba(0,0,0,0.08); text-align:center;">
        <div style="font-size:36px;">ğŸ©º</div>
        <div style="font-size:32px; font-weight:800; color:#0F766E;">{{ stats.medecins }}</div>
        <div style="color:#6B7280; font-size:14px;">MÃ©decins</div>
    </div>

    <div style="background:#fff; border-radius:16px; padding:24px; min-width:180px; box-shadow:0 4px 15px rgba(0,0,0,0.08); text-align:center;">
        <div style="font-size:36px;">ğŸ“…</div>
        <div style="font-size:32px; font-weight:800; color:#F82239;">{{ stats.inscriptionsMois }}</div>
        <div style="color:#6B7280; font-size:14px;">Inscriptions ce mois</div>
    </div>

</div>

{# âœ… Statistiques par risque cardiaque #}
<h3>â¤ï¸ Patients par Risque Cardiaque</h3>
<div style="display:flex; gap:15px; margin-bottom:30px; flex-wrap:wrap;">
    <div style="flex:1; min-width:140px; background:#dcfce7; border-radius:12px; padding:20px; text-align:center;">
        <div style="font-size:32px; font-weight:800; color:green;">{{ statsRisque['NORMAL'] }}</div>
        <div>ğŸŸ¢ NORMAL</div>
    </div>
    <div style="flex:1; min-width:140px; background:#fef9c3; border-radius:12px; padding:20px; text-align:center;">
        <div style="font-size:32px; font-weight:800; color:#ca8a04;">{{ statsRisque['MODÃ‰RÃ‰'] }}</div>
        <div>ğŸŸ¡ MODÃ‰RÃ‰</div>
    </div>
    <div style="flex:1; min-width:140px; background:#ffedd5; border-radius:12px; padding:20px; text-align:center;">
        <div style="font-size:32px; font-weight:800; color:orange;">{{ statsRisque['Ã‰LEVÃ‰'] }}</div>
        <div>ğŸŸ  Ã‰LEVÃ‰</div>
    </div>
    <div style="flex:1; min-width:140px; background:#fee2e2; border-radius:12px; padding:20px; text-align:center;">
        <div style="font-size:32px; font-weight:800; color:red;">{{ statsRisque['CRITIQUE'] }}</div>
        <div>ğŸ”´ CRITIQUE</div>
    </div>
</div>

<h3>ğŸ—‚ï¸ Historique des Alertes IA</h3>

{% if alertes|length > 0 %}
<table border="1">
    <tr>
        <th>Date Pic</th>
        <th>PrÃ©diction</th>
        <th>Statut</th>
        <th>CrÃ©Ã©e le</th>
    </tr>
    {% for alerte in alertes %}
    <tr>
        <td>{{ alerte.datePeak|date('d/m/Y') }}</td>
        <td>{{ alerte.predictionValue|round(0) }}</td>
        <td>
            {% if alerte.status == 'CRITIQUE' %}
                <span style="color:red;">ğŸ”´ CRITIQUE</span>
            {% elseif alerte.status == 'MOYEN' %}
                <span style="color:orange;">ğŸŸ  MOYEN</span>
            {% else %}
                <span style="color:green;">ğŸŸ¢ NORMAL</span>
            {% endif %}
        </td>
        <td>{{ alerte.createdAt|date('d/m/Y H:i') }}</td>
    </tr>
    {% endfor %}
</table>
{% else %}
<p>Aucune alerte gÃ©nÃ©rÃ©e pour le moment.</p>
{% endif %}

{% endblock %}